---
name: rubot-reset
description: Reset rubot workspace to clean state
allowed-tools:
  - Read
  - Bash
  - AskUserQuestion
---

You are in the WORKSPACE RESET PHASE of the rubot orchestration workflow.

## Purpose

Reset the rubot workspace to a clean state, allowing users to start fresh or recover from a corrupted state.

## Reset Options

### Option 1: Soft Reset (Recommended)
- Clears plan.md (sets to empty template)
- Clears validation-report.md
- Preserves rubot.local.md configuration
- Does NOT affect git or code changes

### Option 2: Hard Reset
- Removes entire `.claude/rubot/` directory
- Requires re-running `/rubot-init`
- Does NOT affect git or code changes

### Option 3: Full Reset
- Removes `.claude/rubot/` directory
- Optionally reverts uncommitted code changes
- Optionally removes untracked files
- DANGEROUS: Can lose work

## Reset Process

### Step 1: Confirm Current State

First, show current workspace state:

```bash
# Check what exists
ls -la .claude/rubot/ 2>/dev/null

# Check for uncommitted changes
git status --short

# Check for active PR
gh pr view --json number,title 2>/dev/null || echo "No active PR"
```

### Step 2: Ask User for Reset Type

```
AskUserQuestion({
  questions: [{
    question: "What type of reset would you like to perform?",
    header: "Reset Type",
    options: [
      {
        label: "Soft Reset (Recommended)",
        description: "Clear plan and validation, keep configuration"
      },
      {
        label: "Hard Reset",
        description: "Remove workspace entirely, requires re-init"
      },
      {
        label: "Full Reset",
        description: "Remove workspace and optionally revert code changes"
      },
      {
        label: "Cancel",
        description: "Don't reset, keep everything as is"
      }
    ],
    multiSelect: false
  }]
})
```

### Step 3: Execute Reset

#### Soft Reset

```bash
# Clear plan (keep file, empty content)
cat > .claude/rubot/plan.md << 'EOF'
# Execution Plan

## Status: Not Started

## Tasks

<!-- Plan will be generated by /rubot-plan -->
EOF

# Clear validation report
cat > .claude/rubot/validation-report.md << 'EOF'
# Validation Report

## Status: Not Run

Run `/rubot-check` to validate the codebase.
EOF
```

#### Hard Reset

```bash
# Remove workspace directory
rm -rf .claude/rubot/

# Inform user
echo "Workspace removed. Run /rubot-init to reinitialize."
```

#### Full Reset

First, confirm with additional warning:

```
AskUserQuestion({
  questions: [{
    question: "‚ö†Ô∏è FULL RESET will remove the workspace. Do you also want to revert code changes?",
    header: "Code Changes",
    options: [
      {
        label: "Keep code changes",
        description: "Only reset workspace, preserve all code modifications"
      },
      {
        label: "Discard uncommitted changes",
        description: "Run git checkout . to revert modified files"
      },
      {
        label: "Discard all (including untracked)",
        description: "Run git clean -fd to also remove new files"
      },
      {
        label: "Cancel full reset",
        description: "Go back, don't perform full reset"
      }
    ],
    multiSelect: false
  }]
})
```

Based on response:

**Keep code changes:**
```bash
rm -rf .claude/rubot/
```

**Discard uncommitted:**
```bash
rm -rf .claude/rubot/
git checkout .
```

**Discard all:**
```bash
rm -rf .claude/rubot/
git checkout .
git clean -fd
```

### Step 4: Confirm Reset Complete

After reset, show confirmation:

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                      RESET COMPLETE                           ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë Reset Type: [Soft/Hard/Full]                                  ‚ïë
‚ïë Workspace: [Cleared/Removed]                                  ‚ïë
‚ïë Code Changes: [Preserved/Reverted]                            ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë NEXT STEPS                                                    ‚ïë
‚ïë ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ ‚ïë
‚ïë [Appropriate next command]                                    ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

Next steps based on reset type:
- **Soft Reset**: `/rubot-plan` to create new plan
- **Hard Reset**: `/rubot-init` to reinitialize workspace
- **Full Reset**: `/rubot-init` to start fresh

## Safety Guards

### Prevent Accidental Full Reset

Before full reset, check for:

1. **Uncommitted changes**:
   ```bash
   git status --porcelain
   ```
   If changes exist, warn prominently.

2. **Active PR**:
   ```bash
   gh pr view --json number 2>/dev/null
   ```
   If PR exists, warn that resetting won't close it.

3. **Completed work**:
   Check plan.md for completed tasks.
   If significant work done, warn about losing progress tracking.

### Warning Messages

**Uncommitted Changes Warning:**
```
‚ö†Ô∏è  WARNING: You have uncommitted changes!

Modified files:
  [list of files]

A full reset with "Discard changes" will PERMANENTLY DELETE these modifications.

Consider:
  - Committing your work first: /rubot-commit
  - Stashing changes: git stash
  - Only doing a soft reset
```

**Active PR Warning:**
```
‚ö†Ô∏è  WARNING: You have an active pull request (#[number])

Resetting the workspace will NOT:
  - Close the PR
  - Remove pushed commits
  - Affect the remote branch

The PR will remain open on GitHub.
```

## Enforcement Rules

- ALWAYS confirm before any destructive action
- ALWAYS show what will be affected
- NEVER auto-execute full reset
- NEVER delete files outside `.claude/rubot/` without explicit confirmation
- ALWAYS provide recovery options
- ALWAYS suggest appropriate next steps

## Recovery Information

After reset, remind user:

```
üìù RECOVERY NOTE

If you need to recover:
  - Git history: git reflog
  - Stashed changes: git stash list
  - Deleted files: Check your editor's local history

The rubot workspace can always be recreated with /rubot-init
```
